<br />
<br />
<div class="center">
  <h1>Affichage des résultats par tentative</h1>

  <br /><br />
  <p>
    Permet de consulter la liste des tentatives et visualiser les réponses
    données.
  </p>
  <p><i>Continu à pratiquer pour améliorer tes statistiques !</i></p>
  <br />
  <div class="table-responsive-custom">
    <table class="table table-striped">
      <thead>
        <tr>
          <th></th>
          <th>ID Tentative</th>
          <th>Score</th>
          <th>Début</th>
          <th>Fin</th>
          <th>Durée (minutes)</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let attempt of attempts">
          <td>
            <i
              class="bi bi-eye text-success fs-5"
              (click)="viewAttempt(attempt.id_attempt)"
            ></i>
          </td>
          <td>{{ attempt.id_attempt }}</td>
          <td>{{ attempt.score }}</td>
          <td>{{ attempt.started_at | date : "short" }}</td>
          <td>{{ attempt.ended_at | date : "short" }}</td>
          <td>
            {{
              getDurationMinutes(attempt.started_at, attempt.ended_at)
                | timeFormat
            }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal -->
<div
  class="modal fade"
  id="attemptModal"
  tabindex="-1"
  aria-labelledby="attemptModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content p-3">
      <div class="modal-body" *ngIf="selectedAttemptQuestions">
        <h3>Questionnaire</h3>
        <div *ngFor="let q of selectedAttemptQuestions" class="mb-3">
          <p>
            <b>{{ q.question }}</b>
          </p>
          <div *ngFor="let r of q.responses; let i = index">
            <input
              [type]="q.type === 'single' ? 'radio' : 'checkbox'"
              [name]="'question-' + q.id_question"
              [attr.checked]="r.selected ? true : null"
              disabled
            />
            {{ r.response }}
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          (click)="showAttemptModal = false"
        >
          Fermer
        </button>
      </div>
    </div>
  </div>
</div>
