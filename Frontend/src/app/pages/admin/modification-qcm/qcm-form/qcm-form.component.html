<div class="qcm-form-container" *ngIf="qcmForm">
  <form [formGroup]="qcmForm" (ngSubmit)="save()">
    <!-- Titre et description du QCM -->
    <div class="mb-3">
      <label for="title" class="form-label">Titre</label>
      <input
        id="title"
        type="text"
        class="form-control"
        formControlName="title"
      />
      <div
        *ngIf="qcmForm.get('title')?.invalid && qcmForm.get('title')?.touched"
        class="text-danger"
      >
        Le titre est obligatoire.
      </div>
    </div>

    <div class="mb-3">
      <label for="description" class="form-label">Description</label>
      <textarea
        id="description"
        class="form-control"
        formControlName="description"
      ></textarea>
    </div>

    <!-- Questions -->
    <div formArrayName="questions">
      <div
        *ngFor="let q of questions.controls; let i = index"
        [formGroupName]="i"
        class="card mb-3 p-3"
      >
        <div class="mb-2">
          <label class="form-label">Question {{ i + 1 }}</label>
          <input type="text" class="form-control" formControlName="question" />
        </div>

        <div class="mb-2">
          <label class="form-label">Type</label>
          <select class="form-select" formControlName="type">
            <option value="single">Single</option>
            <option value="multiple">Multiple</option>
          </select>
        </div>

        <!-- Réponses -->
        <div formArrayName="responses" class="ms-3">
          <div
            *ngFor="let r of getResponses(q).controls; let j = index"
            [formGroupName]="j"
            class="mb-2"
          >
            <div class="d-flex align-items-center gap-2">
              <input
                type="text"
                class="form-control"
                formControlName="response"
                placeholder="Réponse"
              />
              <label class="form-check-label"> Correct ? </label>
              <input
                type="checkbox"
                class="form-check-input"
                formControlName="is_correct"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bouton sauvegarder -->
    <div class="mt-3">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="qcmForm.invalid"
      >
        Sauvegarder les modifications
      </button>
    </div>
  </form>
</div>
